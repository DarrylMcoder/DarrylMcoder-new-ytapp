<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>youtube-downloader</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="content">
<h1>| yt-app |</h1>

<p>
  <!--  <a href="https://github.com/Athlon1600/youtube-downloader">https://github.com/Athlon1600/youtube-downloader</a> -->
</p>

<form action="ffmpeg.download.php" method="get">
  <input type="text" value="" class="input" id="txt_url" name="url"><br>
  <button type="button" class="go" id="btn_fetch" value="Fetch">
  Fetch
  </button>
  <button type="submit" class="go">
    Save To Files
  </button>
</form>
    <h3 id="name">
      
    </h3>

<video id="myvideo" controls muted>
    <source src="" type="video/mp4" />
    <audio id="myaudio" controls>
        <source src="" type="audio/mpeg"/>
    </audio>
</video>

<script>
var myvideo = document.getElementById("myvideo");
var myaudio = document.getElementById("myaudio");
myvideo.onplay  = function() { myaudio.play();  }
myvideo.onpause = function() { myaudio.pause(); }
</script>

    
    <p id="description">
      
    </p>


<script>
    $(function () {

        $("#btn_fetch").click(function () {

            var url = $("#txt_url").val();

            var oThis = $(this);
            oThis.attr('disabled', true);

            $.get('ffmpeg.php', {url: url}, function (data) {

                console.log(data);

                oThis.attr('disabled', false);

                var links = data['links'];
                var error = data['error'];
                var name = data['name'];
                var description = data['description'];
              
                $("#name").html(name);
                $("#description").html(description);

                if (error) {
                    alert('Error: ' + error);
                    return;
                }

                // first link with video
                var video = links["video"];
                var audio = links["audio"];

                if (typeof video === 'undefined') {
                    alert('No video found!');
                    return;
                }
              if(typeof audio === undefined)     
              {
                    alert('No audio found!');
                    return;
              }
              alert(video);
              alert(audio);

                var vid_url = 'stream.php?url=' + encodeURIComponent(video);
              
                var aud_url = 'stream.php?url=' + encodeURIComponent(audio);

                var video = $("video");
                video.attr('src', vid_url);
                video[0].load();
              
                var audio = $("audio");
                audio.attr('src', aud_url);
                audio[0].load();
            });

        });

    });
</script>
</div>
</body>
</html>
